<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Sep 27, 2012
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20120927" />
    <meta http-equiv="Content-Language" content="en" />
    <title>jscep - Client</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
              <!-- Google Analytics -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-222968-7']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>jscep</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2012-09-27</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 2.0.1-SNAPSHOT</li>
                      
                
            
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
            
                <ul class="nav nav-list">
                    <li class="nav-header">Main</li>
                                
      <li>
    
                          <a href="index.html" title="Welcome">
          <i class="none"></i>
        Welcome</a>
            </li>
                              <li class="nav-header">Get jscep</li>
                                
      <li>
    
                          <a href="download.html" title="Download">
          <i class="none"></i>
        Download</a>
            </li>
                  
      <li>
    
                          <a href="license.html" title="License">
          <i class="none"></i>
        License</a>
            </li>
                              <li class="nav-header">Documentation</li>
                                
      <li class="active">
    
            <a href="#"><i class="none"></i>Client</a>
          </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                          
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                                                                              
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
            
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <ul><li><a href="#Constructing_a_Client">Constructing a Client</a><ul><li><a href="#Determining_the_URL">Determining the URL</a><ul><li><a href="#Using_a_HTTP_Proxy">Using a HTTP Proxy</a></li><li><a href="#Using_HTTPS">Using HTTPS</a></li></ul></li><li><a href="#Creating_a_Callback_Handler">Creating a Callback Handler</a><ul><li><a href="#Default_Callback_Mechanism">Default Callback Mechanism</a></li><li><a href="#Providing_Your_Own_Callback_Handler">Providing Your Own Callback Handler</a></li></ul></li><li><a href="#Creating_the_Client">Creating the Client</a></li></ul></li><li><a href="#Profiles">Profiles</a></li><li><a href="#Initialising_the_Requester">Initialising the Requester</a><ul><li><a href="#Generating_a_Key_Pair">Generating a Key Pair</a></li><li><a href="#Generating_a_Self-Signed_Certificate">Generating a Self-Signed Certificate</a></li></ul></li><li><a href="#Certificate_Enrollment">Certificate Enrollment</a><ul><li><a href="#Enrolling_a_Certificate">Enrolling a Certificate</a><ul><li><a href="#Enrollment_Response">Enrollment Response</a></li></ul></li><li><a href="#Polling_for_a_Pending_Enrollment">Polling for a Pending Enrollment</a></li></ul></li><li><a href="#Non-Enrollment_Operations">Non-Enrollment Operations</a><ul><li><a href="#CRL_Access">CRL Access</a></li><li><a href="#Certificate_Access">Certificate Access</a></li><li><a href="#CA_Capabilities">CA Capabilities</a></li><li><a href="#CA_Key_Rollover">CA Key Rollover</a></li><li><a href="#RACA_Certificate_Distribution">RA/CA Certificate Distribution</a></li></ul></li><li><a href="#References">References</a></li></ul><div class="section"><h2>Constructing a Client<a name="Constructing_a_Client"></a></h2><p>In order to construct a client, we need two objects:</p><ul><li>a URL</li><li>a Callback Handler</li></ul><div class="section"><h3>Determining the URL<a name="Determining_the_URL"></a></h3><p>The URL should be obtained from your system administrator. In the case of Microsoft NDES, the URL will look like so:</p><div class="source"><pre class="prettyprint">URL url = new URL(&quot;http://[host]/certsrv/mscep_admin/mscep.dll&quot;);
</pre></div><p>In the case of EJBCA, it will look like so:</p><div class="source"><pre class="prettyprint">URL url = new URL(&quot;http://[host]/ejbca/publicweb/apply/scep/pkiclient.exe&quot;);
</pre></div><div class="section"><h4>Using a HTTP Proxy<a name="Using_a_HTTP_Proxy"></a></h4><p>jscep doesn't directly support using a proxy to access your SCEP server, as it doesn't really make sense for SCEP. However, if you need to use a proxy, you can use the mechanism provided by <a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/java/net/ProxySelector.html">ProxySelector</a>, like so:</p><div class="source"><pre class="prettyprint">ProxySelector.setDefault(new ProxySelector() {
    @Override
    public List&lt;Proxy&gt; select(URI uri) {
        Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress(&quot;squid&quot;, 3128);
        return Collections.singletonList(proxy);
    }
    
    @Override
    public void connectFailed(URI uri, SocketAddress sa, IOException ioe) {
        // Do nothing
    } 
});
</pre></div></div><div class="section"><h4>Using HTTPS<a name="Using_HTTPS"></a></h4><p>jscep uses <a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/java/net/HttpURLConnection.html">HttpURLConnection</a> under the hood, and offers full support for HTTPS-enabled SCEP servers - although HTTPS is unnecessary.</p><p>If your SCEP server requires the use of SSL to establish a connection, you may wish to configure <a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/javax/net/ssl/HttpsURLConnection.html">HttpsURLConnection</a> by using the static <a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/javax/net/ssl/HttpsURLConnection.html#setDefaultHostnameVerifier(javax.net.ssl.HostnameVerifier)">setDefaultHostnameVerifier</a> and <a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/javax/net/ssl/HttpsURLConnection.html#setDefaultSSLSocketFactory(javax.net.ssl.SSLSocketFactory)">setDefaultSSLSocketFactory</a> methods. You'll only need to specify a <tt>HostnameVerifier</tt> if your SSL server provides a certificate that doesn't match the hostname in the SCEP URL.</p><p>By default, <tt>HttpsURLConnection</tt> will use the <tt>SSLSocketFactory</tt> as specified by JSSE, so there should be no need to configure it directly. For more information, read the <a class="externalLink" href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/jsse/JSSERefGuide.html">JSSE Reference Guide</a>, particularly the section on <a class="externalLink" href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/jsse/JSSERefGuide.html#Customization">customization</a>.</p></div></div><div class="section"><h3>Creating a Callback Handler<a name="Creating_a_Callback_Handler"></a></h3><p>The callback handler is used to verify the CA certificate being sent by the SCEP server is the certificate you expect. With jscep, you can choose to use either the default callback mechanism with a choice of certificate verifiers, or to provide your own callback handler.</p><div class="section"><h4>Default Callback Mechanism<a name="Default_Callback_Mechanism"></a></h4><p>The default callback mechanism provides a <tt>DefaultCallbackHandler</tt> which delegates verification to a <tt>CertificateVerifier</tt> implementation. jscep supports several strategies for verifying a certificate, including pre-provisioned certificates or digests, and an interactive console verifier.</p><p>The following example shows the steps necessary to configure the console verifier:</p><div class="source"><pre class="prettyprint">  CertificateVerifier verifier = new ConsoleCertificateVerifier();
  CallbackHandler handler = new DefaultCallbackHandler(verifier);
</pre></div><p>By default, jscep will request verification before each operation. If you are performing a number of operations against the same SCEP server, you may wish to cache the users response by decorating the certificate verifier, like so:</p><div class="source"><pre class="prettyprint">  CertificateVerifier consoleVerifier = new ConsoleCertificateVerifier();
  CertificateVerifier verifier = new CachingCertificateVerifier(consoleVerifier);
  CallbackHandler handler = new DefaultCallbackHandler(verifier);
</pre></div></div><div class="section"><h4>Providing Your Own Callback Handler<a name="Providing_Your_Own_Callback_Handler"></a></h4><p>If you wish to use your own <tt>CallbackHandler</tt>, you must handle the <tt>CertificateVerificationCallback</tt>. </p></div></div><div class="section"><h3>Creating the Client<a name="Creating_the_Client"></a></h3><p>To create the client, just combine the two parameters:</p><div class="source"><pre class="prettyprint">Client client = new Client(url, handler);
</pre></div><p>The client is thread-safe, so you can use to enrol multiple entities in parallel if you're using the same CA.</p></div></div><div class="section"><h2>Profiles<a name="Profiles"></a></h2><p>If your SCEP server supports multiple CAs, your CA administrator must provide a string to identify the issuer to use. Each of the operations supported by jscep accepts an optional profile parameter in the form of a <tt>String</tt>.</p><p>Because the jscep client is thread-safe, your application can invoke operations against multiple CA profiles <i>without</i> having to construct a new SCEP client.</p><p><b>Note:</b> Microsoft NDES always requires a profile.</p></div><div class="section"><h2>Initialising the Requester<a name="Initialising_the_Requester"></a></h2><p>In each SCEP message exchange, there are two parties: the requester -- who is enrolling a particular entity into a PKI -- and a SCEP server, which represents the issuing authority, or CA.</p><p>For most operations, the SCEP server requires that the requester sign and encrypt its requests. In turn, the server will sign and encrypt its responses. In order for this to occur, both parties must have a certificate and key pair.</p><p>If the requester has been issued a certificate by the CA, the requester should use that certificate and its associated key pair. Likewise, if the requester has been issued a certificate by a different CA which is trusted by the current CA, then the requester should use <i>that</i> certificate and keypair. Otherwise -- and this is for the majority of cases -- the requester should generate a self-signed certificate.</p><div class="section"><h3>Generating a Key Pair<a name="Generating_a_Key_Pair"></a></h3><p>Before we can generate a certificate, we must first generate a key pair. The SCEP specification only supports RSA, so that is what we will use. The JCA requires Java implementations to support 1024 and 2048-bit keys.</p><div class="source"><pre class="prettyprint">KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;RSA&quot;);
keyPairGenerator.initialize(1024);
KeyPair requesterKeyPair = keyPairGenerator.genKeyPair();
</pre></div></div><div class="section"><h3>Generating a Self-Signed Certificate<a name="Generating_a_Self-Signed_Certificate"></a></h3><p>Once you have your key pair, the next step is to generate an X509 Certificate. The JCA doesn't provide a mechanism for building certificates programatically. However, you <i>can</i> use Bouncy Castle to do it, using either the <a class="externalLink" href="http://www.bouncycastle.org/docs/pkixdocs1.5on/org/bouncycastle/cert/jcajce/JcaX509v1CertificateBuilder.html">JcaX509v1CertificateBuilder</a> or the <a class="externalLink" href="http://www.bouncycastle.org/docs/pkixdocs1.5on/org/bouncycastle/cert/jcajce/JcaX509v3CertificateBuilder.html">JcaX509v3CertificateBuilder</a> class.</p><p>The following example uses <tt>JcaX509v3CertificateBuilder</tt> due to its support for X509 extensions. Bouncy Castle provides classes and interfaces to simplify the usage of extensions through the <a class="externalLink" href="http://www.bouncycastle.org/docs/docs1.5on/org/bouncycastle/asn1/x509/package-summary.html">org.bouncycastle.asn1.x509</a> package.</p><p>If you don't require extensions, you can use <tt>JcaX509v1CertificateBuilder</tt>, which takes the same arguments as <tt>JcaX509v3CertificateBuilder</tt> in its JCA-compatible constructor. In either case, you will need to provide a <tt>ContentSigner</tt>, which can be built using <a class="externalLink" href="http://www.bouncycastle.org/docs/pkixdocs1.5on/org/bouncycastle/operator/jcajce/JcaContentSignerBuilder.html">JcaContentSignerBuilder</a>. SCEP supports the following signature algorithms:</p><ul><li><tt>MD5withRSA</tt></li><li><tt>SHA1withRSA</tt></li><li><tt>SHA256withRSA</tt></li><li><tt>SHA512withRSA</tt></li></ul><p>You can find out the strongest signature algorithm supported by your SCEP server by using the following snippet.</p><div class="source"><pre class="prettyprint">Capabilities caps = client.getCaCapabilities();
String sigAlg = caps.getStrongestSignatureAlgorithm();
</pre></div><p><b>Note</b>: if you're using a self-signed certificate, your certificate subject X500 name <i>must</i> be the same as the subject in your certificate-signing request. </p><div class="source"><pre class="prettyprint">// Mandatory
X500Principal requesterIssuer = new X500Principal(&quot;CN=jscep.org, L=Cardiff, ST=Wales, C=UK&quot;);
BigInteger serial = BigInteger.ONE;
Calendar calendar = Calendar.getInstance();
calendar.add(Calendar.DATE, -1); // yesterday
Date notBefore = calendar.getTime();
calendar.add(Calendar.DATE, +2); // tomorrow
Date notAfter = calendar.getTime();
X500Principal requesterSubject = new X500Principal(&quot;CN=jscep.org, L=Cardiff, ST=Wales, C=UK&quot;); // doesn't need to be the same as issuer
PublicKey requesterPubKey = requesterKeyPair.getPublic(); // from generated key pair
JcaX509v3CertificateBuilder certBuilder = new JcaX509v3CertificateBuilder(requesterIssuer, serial, notBefore, notAfter, requesterSubject, requesterPubKey);

// Optional extensions
certBuilder.addExtension(X509Extension.keyUsage, false, new KeyUsage(KeyUsage.digitalSignature));

// Signing
PrivateKey requesterPrivKey = requesterKeyPair.getPrivate(); // from generated key pair
JcaContentSignerBuilder certSignerBuilder = new JcaContentSignerBuilder(sigAlg); // from above
ContentSigner certSigner = signerBuilder.build(requesterPrivKey);

X509CertificateHolder certHolder = certBuilder.build(certSigner);
</pre></div><p>You can extract a JCA-compatible certificate by using the <a class="externalLink" href="http://www.bouncycastle.org/docs/pkixdocs1.5on/org/bouncycastle/cert/jcajce/JcaX509CertificateConverter.html">JcaX509CertificateConverter</a>:</p><div class="source"><pre class="prettyprint">JcaX509CertificateConverter converter = new JcaX509CertificateConverter();
X509Certificate requesterCert = converter.getCertificate(certHolder);
</pre></div><p>Congratulations! You now have everything you need to invoke operations against your SCEP server.</p></div></div><div class="section"><h2>Certificate Enrollment<a name="Certificate_Enrollment"></a></h2><p>Certificate enrollment is the primary use-case for using the SCEP protocol.</p><div class="section"><h3>Enrolling a Certificate<a name="Enrolling_a_Certificate"></a></h3><p>When enrolling an entity into a PKI, you should generate a new key pair to represent the entity, as shown in the following snippet. There is no reason not to reuse the <tt>KeyPairGenerator</tt> from the earlier steps, but we'll create another here for simplicity.</p><div class="source"><pre class="prettyprint">KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;RSA&quot;);
keyPairGenerator.initialize(1024);
KeyPair entityKeyPair = keyPairGenerator.genKeyPair();
</pre></div><p>We'll name this key pair <tt>entityKeyPair</tt> to distinguish it from the key pair used to represent the SCEP client, which is named <tt>requesterKeyPair</tt>. After the key pair has been created, we need to start creating the signing request to send to the CA. Since the JCA does not support the creation of CSRs, we'll use Bouncy Castle again:</p><div class="source"><pre class="prettyprint">X500Principal entitySubject = requesterSubject; // use the same subject as the self-signed certificate
PublicKey entityPubKey = entityPair.getPublic();
PKCS10CertificationRequestBuilder csrBuilder = new JcaPKCS10CertificationRequestBuilder(entitySubject, entityPubKey); 
</pre></div><p>We can now use the <tt>PKCS10CertificationRequestBuilder</tt> to add extensions. Depending on your SCEP server, you may need to provide additional extensions, but in <i>most</i> cases, you'll add a PKCS#9 <tt>challengePassword</tt>:</p><div class="source"><pre class="prettyprint">DERPrintableString password = new DERPrintableString(&quot;password&quot;);
csrBuilder.addAttribute(PKCSObjectIdentifiers.pkcs_9_at_challengePassword, password);
</pre></div><p>If you're renewing a certificate, you should still send an empty password, as per the following snippet, but the SCEP server must validate the request against the requester certificate, <tt>requesterCert</tt>.</p><div class="source"><pre class="prettyprint">DERPrintableString password = new DERPrintableString(&quot;&quot;);
csrBuilder.addAttribute(PKCSObjectIdentifiers.pkcs_9_at_challengePassword, password);
</pre></div><p>When you've finished adding your extensions, you must then sign your CSR with your entity's private key.</p><div class="source"><pre class="prettyprint">PrivateKey entityPrivKey = entityPair.getPrivate();
JcaContentSignerBuilder csrSignerBuilder = new JcaContentSignerBuilder(&quot;SHA1withRSA&quot;);
ContentSigner csrSigner = csrSignerBuilder.build(entityPrivKey);
PKCS10CertificationRequest csr = csrBuilder.build(csrSigner);
</pre></div><p>You now have everthing you need to enrol. The next line in your application will typically be to send the CSR to the SCEP server, and to assign the response.</p><div class="source"><pre class="prettyprint">EnrollmentResponse res = client.enrol(requesterCert, requesterPrivKey, csr);
</pre></div><p>Understanding the server response is critical for knowing what to do next.</p><div class="section"><h4>Enrollment Response<a name="Enrollment_Response"></a></h4><p>The <tt>EnrollmentResponse</tt> returned by <tt>Client.enrol()</tt> and <tt>Client.poll()</tt> should be inspected by your application to determine what to do next. <tt>EnrollmentResponse</tt> contains three methods which can be used to determine the state of the response:</p><ul><li><tt>isSuccess()</tt></li><li><tt>isPending()</tt></li><li><tt>isFailure()</tt></li></ul><p>If <tt>isSuccess()</tt> returns <tt>true</tt>, your application should call <tt>getCertStore()</tt> to retrieve the enrolled certificates. For a lot of applications, this will be the last interaction you have with the jscep client. </p><p>If <tt>isFailure()</tt> returns <tt>true</tt>, your application should call <tt>getFailInfo()</tt> to determine the reason for failure. Applications should treat this as a permanent failure. Unfortunately, the SCEP protocol doesn't provide a lot of detail for failure reasons, so it is non-trivial to make your application resilient to SCEP failure.</p><p>The last method, <tt>isPending()</tt>, is guaranteed to be <tt>true</tt> if the other two methods return <tt>false</tt>. For pending responses, your application should call <tt>getTransactionId()</tt>, and use the returned <tt>TransactionId</tt> when invoking <tt>Client.poll()</tt>, as detailed below.</p><p>Your application may use a number of different approaches for sending a poll request to the server, and jscep does not attempt to second-guess how your application will want to approach this situation. However, it should be noted that all of the classes used as arguments to <tt>poll</tt> implement <tt>Serializable</tt> and are immutable, so can safely be used in different threads and even in different JVMs.</p><p>Applications are <b>strongly</b> recommended not to pass the requester <tt>PrivateKey</tt> around in the clear. The JCA provides the <tt>KeyStore</tt> class for securely storing keys, and can store the requester certificate and pair like so:</p><div class="source"><pre class="prettyprint">KeyStore store = KeyStore.getInstance(&quot;JKS&quot;);
store.load(null, null);
store.setKeyEntry(&quot;requester&quot;, requesterPrivKey, &quot;secret&quot;.toCharArray(), requesterCert);

ByteArrayOutputStream bOut = new ByteArrayOutputStream();
store.store(bOut, &quot;secret&quot;.toCharArray());
</pre></div><p>Alternatively, applications can use a <tt>SealedObject</tt> to simplify serialization, but this is arguably more complicated.</p></div></div><div class="section"><h3>Polling for a Pending Enrollment<a name="Polling_for_a_Pending_Enrollment"></a></h3><p>If your application has previously received a <i>pending</i> response, your application should poll the SCEP server to determine the current state of the enrollment. The <tt>poll()</tt> method returns the same type as the <tt>enrol()</tt> method, so applications should follow the same steps to determine the <i>current</i> state of the enrollment.</p><div class="source"><pre class="prettyprint">EnrollmentResponse res = client.poll(requesterCert, requesterPrivKey, subject, transId);
</pre></div><p>Since issuing a certificate may involve a lengthy manual process, your application may have to make numerous polling requests.</p></div></div><div class="section"><h2>Non-Enrollment Operations<a name="Non-Enrollment_Operations"></a></h2><div class="section"><h3>CRL Access<a name="CRL_Access"></a></h3><p>If you need to retrieve a CRL for a particular certificate.</p><div class="source"><pre class="prettyprint">X509CRL crl = client.getRevocationList(cert, keyPair.getPrivate(), issuer, serial);
</pre></div></div><div class="section"><h3>Certificate Access<a name="Certificate_Access"></a></h3><p>If you need to access a certificate that was previously issued, you need only pass the serial number of the certificate:</p><div class="source"><pre class="prettyprint">CertStore store = client.getCertificate(cert, keyPair.getPrivate(), serial);
</pre></div></div><div class="section"><h3>CA Capabilities<a name="CA_Capabilities"></a></h3><p>The capabilities of the SCEP are used extensively by internal jscep operations, for determining the cipher to use for key wrapping in the <tt>pkcsPkiEnvelope</tt> structure, and for the signature to use for signing the <tt>pkiMessage</tt> structure. </p><p>This operation is used to determine how to interact with the server. </p><p>By default, jscep will invoke this operation to determine which algorithms to use when constructing secure message objects. </p><div class="source"><pre class="prettyprint">Capabilities capabilities = client.getCaCapabilities();
</pre></div><ul><li>Digest Algorithms:<ul><li>MD5</li><li>SHA-1</li><li>SHA-256</li><li>SHA-512</li></ul></li><li>Ciphers:<ul><li>DES</li><li>Triple DES</li></ul></li><li>Use of HTTP POST</li></ul><p>See: <a name="http:tools.ietf.orghtmldraft-nourse-scep-23appendix-C">http://tools.ietf.org/html/draft-nourse-scep-23#appendix-C</a></p></div><div class="section"><h3>CA Key Rollover<a name="CA_Key_Rollover"></a></h3><div class="source"><pre class="prettyprint">CertStore store = client.getRolloverCertificate();
</pre></div><p>See: <a name="http:tools.ietf.orghtmldraft-nourse-scep-23appendix-E">http://tools.ietf.org/html/draft-nourse-scep-23#appendix-E</a></p></div><div class="section"><h3>RA/CA Certificate Distribution<a name="RACA_Certificate_Distribution"></a></h3><p>Retrieving the CA and RA certificates from the SCEP server is an important operation.</p><div class="source"><pre class="prettyprint">CertStore store = client.getCaCertificate();
</pre></div></div></div><div class="section"><h2>References<a name="References"></a></h2><ul><li><a class="externalLink" href="http://www.bouncycastle.org/docs/pkixdocs1.5on/index.html">Bouncy Castle PKIX and CMS Documentation</a></li><li><a class="externalLink" href="http://www.bouncycastle.org/docs/docs1.5on/index.html">Bouncy Castle Provider and Main Documentation</a></li><li><a class="externalLink" href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/">Java 6 Security</a></li></ul></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2009-2012.
          All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
